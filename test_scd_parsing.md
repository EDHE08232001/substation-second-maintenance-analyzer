# SCD文件解析测试说明

## 问题诊断

根据日志分析，发现以下问题：

1. **数据集名称解析错误**：
   - 日志显示：`发现数据集: `（空字符串）
   - 原因：数据集行的格式是 `\t数据集名称\t数据集引用\t类型`
   - 原代码错误地从 `parts[0]` 获取数据集名称，但 `parts[0]` 是空字符串

2. **明细行解析失败**：
   - 日志显示：`装置 NSR_3611线路保护测控装置 有 0 个明细`
   - 原因：由于数据集名称为空，明细行可能没有被正确解析

## 修复内容

### 1. 数据集行解析修复
```java
// 修复前
if (parts.length >= 2) {
    currentDatasetName = parts[0].trim(); // 错误：parts[0] 是空字符串
}

// 修复后  
if (parts.length >= 3) {
    // 数据集行的格式：\t数据集名称\t数据集引用\t类型
    // parts[0] 是空字符串（因为行以制表符开头）
    // parts[1] 是数据集名称
    // parts[2] 是数据集引用
    currentDatasetName = parts[1].trim(); // 正确：从 parts[1] 获取数据集名称
}
```

### 2. 调试信息增强
- 添加了数据集行原始内容的调试信息
- 添加了明细行处理的调试信息
- 添加了文件前10行的调试信息

## 测试步骤

1. 重新上传SCD文件
2. 查看日志输出：
   - 检查数据集行是否正确解析
   - 检查明细行是否被正确识别
   - 检查 `dataSetName` 字段是否正确设置

## 预期结果

修复后应该看到：
- 日志显示：`发现数据集: '遥信数据集'`
- 日志显示：`装置 NSR_3611线路保护测控装置 有 X 个明细`
- 数据库中 `data_set_name` 字段有正确的值

## 文件格式示例

```
NSR_3611线路保护测控装置	P3611	192.168.3.225	14	1
	遥信数据集	P3611CTRL/LLN0.dsDin	138
		NSR_3611线路保护测控装置实遥信装置检修	P3611CTRL/Q0GGIO1.Ind1.stVal[ST]	5	0	0	1
```

- 装置行：无制表符前缀
- 数据集行：一个制表符前缀，格式为 `\t数据集名称\t数据集引用\t类型`
- 明细行：两个制表符前缀 